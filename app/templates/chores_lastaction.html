{% extends "base.html" %}
{% block content %}
	<h2>Last action on chores</h2>
	<table class="table table-striped">
		<tr>
			<th>Chore ID</th>
			<th>Chore</th>
			<th>Last Actioned</th>
			<th>#Days</th>
			<th></th>
		</tr>
		<tr class="info">
			<form action="{{ url_for('new_chore')}}" method="POST">
				<td></td>
				<td>
					<input type="text" name='chore' value="new chore"/>
				</td>
				<td></td>
				<td></td>
				<td>
					<input type="submit" value="add"/>
				</td>
			</form>
		</tr>
		{% for row in rows %}
			<tr>
				<td>{{ row.chore_id }}</td>
				<td>{{ row.chore }}</td>
				<td>{{ row.last_actioned }}</td>
				<td>{{ row.last_actioned | dayssince }}
				<td><a href='#' onclick="deletechore({{ row.chore_id }})"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>  <a href="#" onclick="edit( {{ row.chore_id }}, '{{ row.chore }}')"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>  <a href={{ url_for('new_from_chore',id=row.chore_id) }}><span class="glyphicon glyphicon-expand" aria-hidden="true"></span></a></td>
			</tr>
		{% endfor %}
	</table>

	<!-- editModal -->
	<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="editModalLabel">Edit chore</h4>
				</div>
				<div class="modal-body">
				<form class="form-horizontal" id='editModalForm' method="POST" action='{{ url_for('edit_chore') }}'>
					<div class="form-group">
						<label for='editModalID' class='col-sm-2 control-label'>Chore id</label>
						<div class="col-sm-2">
							<input name='id' type=number class='form-control' id='editModalID' readonly/>
						</div>
					</div>
					<div class="form-group">
						<label for='editModalChore' class='col-sm-2 control-label'>Chore</label>
						<div class="col-sm-10">
							<input type=text name='chore' class='form-control' id='editModalChore'/>
						</div>
					</div>
				</form>

				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button id="editModalSavebutton" type="button" class="btn btn-primary">Save changes</button>
				</div>
			</div>
		</div>
	</div>
	<!-- deleteModal -->
	<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					<h4 class="modal-title" id="editModalLabel">Edit chore</h4>
				</div>
				<div class="modal-body">
					<p>Are you sure you want to delete this chore?</p>
					<center>
					<button type="button" class="btn btn-default" data-dismiss="modal">No</button>
					<a href='#' id='deletebutton' type='button' class='btn btn-primary'>Yes</a>
					</center>
				</div>
				<div class="modal-footer">
				</div>
			</div>
		</div>
	</div>
	<script>
	function edit(id, chore){
		$('#editModalID').val(id);
		$('#editModalChore').val(chore);
		$('#editModal').modal('show');
	}

	function deletechore(id){
		$('#deletebutton').attr('href',"/delete_chore/" +id.toString());
		$('#deleteModal').modal('show');
		}

	$('#editModalSavebutton').click(function(){
		$('form#editModalForm')[0].submit();
	});
	</script>

{% endblock %}
